## overview
- Horiziontal is addming more ec2 instance and having you app run in different timezones
- vertical scaling is increasing hardware size / capacity

# ELB Elastic Load balancer
## Overview
- A server or a set of server that will foward traffic to to multiple servers (Ec2 instnace) donwstream
- spread the load acroos multiple downstreams
- Expose a single point of access DNS to your application
- Seamlessly hadle failures of downstream instance because your load balance will have the health state of your ec2 isntance
- Do regular health checks on your instance
- Provided ssl termination HTTPS for your websites
- Enforce stickyness with cookies
- high availabilty across zones
- Seperate public from private traffic

## why use elbs
- ELBS is a manages load balancer
- AWS guartees that it will be working
- AWS takes care of the upgrades maintenance high availability
- AWS only provides a few configuration knobs
- It cost less to setup your own load balancer bit it will be high lift
- is integrated with alot og aws offering

## Health checks
- A way for your elb to check the health of the ec2 instance so that it doesn't send any traffic over to it
- the ec2 isntance has a health endpoint
- if the responnse is not 200 its not up

# Types of load balancers
# Types
** classic load balacner**: supports http https tcp and ssl aws does not want you to use this one deprecated

**Application Load balancer**: supports htttp https and wensockets

**netowrk load balancer **: suports tcp tls and udp

**gateway laod balcne**: operate at layer 3 netowrk level

## other notes
- the elb will have sourese 0.0.0.0 which means that it will accept traffic from anywhere
- this means that your ec2 instance should only accept traffic from the elb
- security group rule of the elb will have port 80 open and then the sourse will be a security group link security gorup of the ec2 isntance to the secuirty gorup of the elb

# application load balancer
## Overview
- Application load balancer is layer 7 so it for http
- It allows you to route to multole applications across machines
- support for http2 and wensockets
- Load balancing to multiple applications on the same machine
- support for redirects from http to https for example
- It also supprts rute routing
- You have to create a target group and then you can attach a load balancer to the target group
- You need to registed on port 80

## Advanced concepts for the Load balance
- instance laund wizard change the http rule and only allow the load balancer add a new http rule and add the security group
- attach the security group of the alb
- You can add some rules in the listeners if th port of the load blancer path / get post source ip query strings and headers

# Network load balacer
## overview
- Network load balancers are layer 4 they allow to forward tcp and udp traffiv to your instance
- Handle millions od requests per second
- NLB has one static ip per az
- You can assigna an elastic up to each az
- when you see a question about high traffic and only allowing a couple of ip address you should think nlb tcpn udp
- Not include in the aws free tier

## NLB target groups
- Ec2 instances
- Ip addresses must be private address
- You can have the NLB sit in front of an alb you can have a fixed ip address and then the secuirty rules of the alb
- Health checks support the tcp http and https protocall
- it is possible fo you to define health checkisn ont the protocall

# Gateway load balancer
## overview
- Deploy scale and manage a fleet of 3rd party virtual appliances
- Example firewalls intrusin detection and precention systems deep packet inspection system payload inspection
- first goes to the gatwa laod balancer and the applicaances will do what they do if its accepted it will go trhough the balacnce again
- it used to analyic netwoek traffic
- combines the following functions transparent network gateway singlt entry / exit point for all traffic

## Gateway load balancer target groups
- Ec2 isntances
- ip addresses
- the ip address must be private
- that would be if you are hosting your own server
- Use GENEVE protocol to commumicatre with the target

## sticky sessions(session affinity)
- It possible to implement stickiness so that the same client is always redirected to the same instace behind a load balancer
- This works for classic load balancer alb and nlb
- the cookie used for stickiness has an expiration dat you contron
- use case make sure that the user doesn't loose the session data

# sicky sessions cookie names
# application based cookies
## custom cookei
- generated by the targe
- can include any custom attibutes required by the application

**todo**: add the rest of the notes from work computer

# cross zone load balancing
## Overview
- with cross zone load balancing each load balancer isntance distributes traffic evenly across all registered instances in all az
- Cliet itself is sending 50 50 to each load balancer but each load balancer is going to redirect that traffi acroos all instances regardless of the az that they are in
- not have cross zone - reuqest are distrubeted in the instances of the node of the elastic load balancer
- clietn send traffic will send the traffic within its region
- abl enabled by default can diable at the target group lebel
- nlb and glb cross load balancing is disabled by default

## SSL TLS basics
- an ssl cert allows traffic betwen your client and your load balancer to be encrypted in tranist called in flight encryption
- ssl refers to secure socket layer
- TLS refers to the transport layer securtiy which is a newer version
- tls cers are mainly used refered to as ssl
- issued by ca
- they have an expirty date and must be renewed
- the load balancer will issue a x.509 cer
- you can manage certifcates using ACM
- you can also upload your own certs to acm
- you must spec a default cer for the load balancer
- sni server name indication

## sni
- sni solves the problem of loading multiple ssl certs onto one web server to serve multiple sites
- its a newer protocal that requires the client to indicate the hostmname of the target sever in tht inital ssl HS
- only works for apllication LB and netwoek LB

# Amazon RDS overview
## overview
- Rds stands for relationla database
- Its a managed DB service that uses sql as the query language
- it allows you to create dbs in the cloud that are managed with aws
- DB that are rds mariadb postqres mysql oracle mssql server imb db2 aura(amazons proprietary ddb)
- Advantage of using RDS versus deploying a db on an ec2 instance
- RDS is a managed service
- Automated provisioning and os patching
- Continues backoup and restore to specific timestamp point in time restore
- Monitoring dashboars to give you performance of the db
- Read replica for improved performance spee
- Multi az for DR - disaster recovery
- Maintenace windows for upgrades
- scalling both vertial by scalling the instace type and horiziontal by adding more read replicas
- Storage is backe by an ebs gp2 or io1
- you can not ssh into your db instances

## RDS Sotrage auto scalling
- Helps you increase sotrage on your RDS db dynamiclly
- avoid manually scalling your db storage
- To manually scale your dn storage you need to set maximum threshold (max limit for your db)
- Automatily modify sotrage if free storage is less than 10% of allocated sotrage and the low storage last for at least 5 mins
- and 6y hours have passed since the last mod
- Useful for applications with unpredictable workloads
- supports all rds database engine

## RDS read replica for scalabilit
- for the exam it is important to understand the difference between read replica and across az
- Read replica help you scale your reads
- can create up to 15 read replicas
- wihing the same availability zone cross az or cross region

## RDS MZ
- mostly used for disaster recovery
- SYNC replication
- creats a snapshot of the db and then creates a db in another az and then sync the changes
- one dns name autmaic app failover to standby
- increasing availability
- failover incase of case of loss of az loss of az
- No manual interventin in app
- not used for scaling

## from single to multi az
- how to go from single multi az
- Zero downtime
- zero downtime operation (no need to stop db)
- Just click on modify on the db and enable multi az
- that measn that the master is going to have a standby copy of the db
- Creates a snapshot and then replicates the db

## RDS custom
- Can and do Have access to the underlying infrastructure
- Manged oracle and microsoft sql  server database with os and database custpmization
- RDS automates setup opernation and scalling in aws
- the custom is getting acess to underlying infrastructure ussing ssh and ssm
- it is recommended to diactive the autmation mode to perform your customization better to take a db snapshot before

## Auroa
- Auroa is propritary technology from aws (not open source)
- Postgres and mysql are both supported as auroa db
- Aura is cloud optimized and claims 5x performance improvement over mysel on rdsand over 3x on 
- Aurora sotrage automaticly grows inincrements of 10gbup to 128gb
- Aurora can have up to 15 replicas and the replication process is faster then mysql subs 10ms
- failover in aurora is instantaneuos It HA natice
- aurora cost more thank RDS but is more efficent
- store 6 copies of your data across 3 az
- 4 copies out of 6 needed for writes
- 3 copies out of 6 needed for reads
- self heling with peer to peer replication if somehting is currupted the other dbs will restore the data
- shared sotrage volume from 10gb to 128gb
- Master is the only thing that will write to the storage writer endoint
- you can have have auto scaling on your read replicas
- there is load balancing there is reader endpoint that is a LB to the autoscaller replcas
- if the writes are fowrded to the read replicas  then you could turn on write fowarding that will redirct your undirect fwd to write
- can careate an auto scalling policy based on the avrage cpu or varge connections

# auroa advanced concetps
**auto scaling**: based on cpu the auto scaller wiill create more read replicas and will also extend the enpoint so that your repliucs will start getting traffic

**custom endpoints**: some read replicas are different than others and you can connectc them to different edpoints

**serverless**: Automated database instantaion and auto scaling based on actual usge

## severllss continute
- Good for infrequent intermitten or upredicatble workload
- No need to do any capacity planning pay per secon can be more cost effective
- Yout client will talk to a proxy fleet that is managed by auroa
- Global aurora Aurora cross refion read replicas useful for disaster recovery and simple to put in place
- you can setup 5 secondary  read ony regiond replication laf is less than 1 second
- UP to 16 read replicas pers secodary region

## machine learning
- Allows you to add ML bassedd predictions to you app via sql
- simple optimizied and secure intergration between auroa ans aws mlms servises
- Amazoon sage maker allwos your to use the machine with any ml model
- Amazon chomprehend for sentiment analysis
- use cases fraud detection ads targeting sentiment analusis product recommendation
- RDS backups
- daily ful backups of the databse (during the backup window)
- transactions are backed by rds every 5 minutes
- ability to restore to any point in time (from oldest backup to 5minutes ago)
- 1 to 35 days of retention set 0 to diable automatic backups
- manual db snapatopts
- manyyualy triffers by the user
- manyal backup never expires
- if you want to save some cost
- the snapshots cost you way less thatn having the db running
- aurora backup 1 to 35 days cannot be disabled

## rds and aurora restore options
- Resotring rds aurora backup or a snapshot creates a new database
- restoruing a msql rds databse from s2
- create a backup of your own on premise database
- restore the backup file onto a new rds instance running mysql
- Restoring mysql aurora from cluster s3
- create a backp of your on-premise databse using precona xtrabackup
- store the bakup fiel on s3
- restore the backup file onto a new aurru cluseter runnig mysql

## aurora database cloning
- create a new aurora db cluster from an existing one
- copy prod db to stagin db
-  faster than doing a snapshot and resoroe
- uses copy on write protocol
- inintally the new db cluster uses the same data volume as the originla db cluster
- when updates are made to the new db cluster data then additional sotrage is allocated and data is copeid to be seperated
- very fast and cost effectve and usefult to have stagin from prof

## rds securtiy
- at rest encryption database master and replicas encryption using AWS KMS must be defined at launch time
- if the master is no encrypted the read replicas cannot be encrypted
- to ecrtypt an unecrypted db you must create a snapshot and then create a new encypted db from the snapshot
- in flight encryption TLS ready by default use aws tls root certificate client side
- IAM auth rolse dconnect to your databse
- can allow access network access to your rds using security groups 
- no ssh available
- Audit logs can be enabled and sent to cloudwatch logs for longer retention

# AMAZON RDS proxy
## overview
- fully managed databse proxy
- allows application to poool and share db sconnections esablished with the database
- imporoves database effeiceny by reducing the stress on the db
- seveeless autoscalling multu az hgigh availibly
- reduce failover time by up 66
- enforce iam authentication for db and securely store credentaals in aws secrets manage
- rds proxu is never prublicky accesable must be acces from the vpc
- lambda functions can connect to the rds proxy

## elaticache
- The same way rds is to get managed relational databses elasticache is to get managed redis memcache
- what is cahces caches are in memory databses with relly high performance low lateny
- Help reduce load off databases for read intesive workloads
- helps make your application statless
- aws takes care of os maintenance/patching optimizations setups configuration monitoring, failure recovery and backup
- Heavy application code changes
- caches must have an invalidation strategy to make sure only the most current data is used there
- soring user session application will write session data to cache

# redis vs memcaches
## redis
- multi az with auto failover
- read replicas to scaled reads and have high availibility
- data durability using aof persistence
- backup and restore features
- supprts sets and soreted set

## memcache
- multi node for partitioning of data sharing
- no high availability no persistent data no backup and restore multi threaded architecture

## elastiCache security
- ealssti cahce suppports IAM autentication for redis
- iam polices in elstic cache are on ly used for aws apu leverl
- redis authentication you can set a password token when you create a redis cluster
- this is an extra layer of secuitity for your cache on top of securtiy groups
- support ssl in flihgt encryption
- memchse supports sasle based auth

# patters for elastic chache
## lazy loading
- all the read data is cahced
- data can become stale in cache

## write through
- adds or updates data in the cache when wrritten to a db

## session store
- sotre temporary session data in cache using tttl features

**elastic cache redis use case**: gaming leaderboard are computationally complex redis sorted set guarantee both uniqueness and element ordering

**more**: each tome a new element added, its ranked in real time, then added in correct order

## list of ports to be familiar with
- https 443
- postgresq' 54432
- ftp 21
- ssh 22
- http 80
- https 443
- myswl 3306
- msswl 1433
- mara db 1433 same as msql
- aurrora 5432 same as postgres or 3306 if msql comp

